
# MARK12-MONOLITH: JAX-Powered Fusion Fleet Simulator

**Mark12-Monolith** is a high-performance, physics-first digital twin simulator designed for modeling and controlling a fleet of advanced fusion reactor modules. 

Built on the **JAX** framework, it leverages JIT compilation, hardware acceleration (GPU/TPU), and automatic differentiation to provide a differentiable surrogate physics engine coupled with a receding-horizon Model Predictive Controller (MPC).

---

## üöÄ Key Features

*   **Differentiable Physics Engine (Surrogate Model):** A high-fidelity, deterministic surrogate that models core alpha heating, neutron energy transport (with delay queues), and multi-stage heat recovery.
*   **Receding-Horizon MPC:** An independent per-module optimizer utilizing the **Adam optimizer** via JAX‚Äôs `value_and_grad` functions. It dynamically optimizes fusion input to maximize electricity output while maintaining thermal safety.
*   **Stochastic Monte-Carlo (MC) Validation:** A dedicated validation plugin for non-deterministic neutronics. It uses JAX‚Äôs PRNG keys to simulate probabilistic blanket capture and tritium breeding rates.
*   **Vectorized Fleet Management:** Utilizes `jax.vmap` and `jax.lax.scan` to simulate an entire fleet of reactors in parallel with negligible performance overhead.
*   **Energy Conservation Auditing:** Built-in telemetry and auditing systems that track energy residuals, ensuring the simulation adheres to the laws of thermodynamics.
*   **High-Precision Numerics:** Enabled `float64` support (X64) for scientific-grade precision in energy bookkeeping.

---

## üèó System Architecture

The simulator models a complex energy flow between six primary storage domains:
1.  **CORE:** Primary fusion reaction chamber (Alpha heating).
2.  **BUFFER:** Thermal storage for recovered energy from recuperation.
3.  **ELEC:** Final electrical output via Direct Energy Conversion (DEC).
4.  **BLANKET:** Neutron energy capture and thermal conversion.
5.  **STRUCT:** Structural heating and thermal loss management.
6.  **BREED:** Tritium breeding energy accounting.

---

## üõ† Installation

To run the simulation, ensure you have Python 3.9+ and the required JAX dependencies installed:

```bash
pip install "jax[cpu]==0.4.13" "jaxlib==0.4.13" numpy
```

*Note: For GPU acceleration, please refer to the [official JAX installation guide](https://github.com/google/jax#installation).*

---

## üíª Usage

Simply run the monolithic script to execute a full MPC-optimized validation rollout:

```bash
python mark12_monolith.py
```

### Generated Outputs:
*   `mark12_Useq.csv`: Detailed control sequences (Fusion Power in Watts) generated by the MPC for each module.
*   `mark12_summary.csv`: Final energy yields, breeding totals, and computational performance metrics.

---

## üß™ Technical Specifications

*   **Optimizer:** Adam (Adaptive Moment Estimation) for receding horizon control.
*   **Backend:** XLA (Accelerated Linear Algebra).
*   **Transport Model:** Delayed neutron queue (configurable $D$-stage delay).
*   **Efficiency Model:** Non-linear Recuperation Efficiency and Temperature-dependent Direct Energy Conversion (DEC) curves.

---

## üë• Authors

*   **Hari Hardiyan (AI Tamer)** - *Conceptualization & Logic Architecture*
*   **GitHub Copilot** - *Implementation & Optimization Assistant*

---

## üìÑ License

This project is licensed under the MIT License.

---
*Disclaimer: This is a research-grade simulation environment intended for educational and conceptual modeling of fusion energy systems.*
```

***

 
